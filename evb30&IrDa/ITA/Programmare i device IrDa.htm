<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns="http://www.w3.org/TR/REC-html40" xmlns:v = 
"urn:schemas-microsoft-com:vml" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:w = 
"urn:schemas-microsoft-com:office:word" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><HEAD><TITLE>Programmare i device IrDa</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content=Word.Document name=ProgId>
<META content="MSHTML 6.00.2715.400" name=GENERATOR>
<META content="Microsoft Word 10" name=Originator>
<META 
content="Berardi Michele Programmatore Senior Developer http://web.tiscali.it/mberardi/ e-mail: 03473192000@vizzavi.it mfxaub@tin.it mobile: +39 347 319 2000 Customize Your Opportunities!" 
name=author>
<META 
content="http://web.tiscali.it/mberardi/  Berardi Michele programmatore senior con esperienze concomitanti sia nella ricerca e sviluppo su sistemi wireless e palmari che web programming nonchè programmazione classica , amministrazione e gestione della sicurezza e del problem solving attinente la gestione sia dei sistemi Unix che windows. La sua esperienza si fonda su solide nozioni classiche di algoritmica e programmazione che su ricerca continua all'innovazione ed al miglioramento delle conoscenze in sintonia con i tempi. Come valore aggiunto offre una forte capacità creativa e di integrazione con i commerciali ed in genere nel team working." 
name=description>
<META 
content="web agency, website, siti, internet, web, solutions, maintenance, creations, toys, advertise, games, giochi, flash, Tin.it, Virgilio, Seat pagine gialle, advertising, consulenza, net added value, new economy, tecnologia, web oriented, webdesign, search engines, registrazione nei motori, motori di ricerca, usability, usabilità, spazio web, registrazione dominio, commercio elettronico, connettività, mobile, marketing, multimedia, business-to-business, business-to-consumer, b2b, b2c, umts, wap, gprs, wireless, e-commerce, portali, web portal, hosting, programmazione, asp, php, ASP, xml, html, javascript, java, js, css, action scripts, dhtml, dynamic, xhtml, vbscript, cgi, sql, perl, carrello elettronico, database, Foggia, provincia di Foggia, Puglia, Italia, Italy , Programmatore, developer, creative, analyst, senior, embedded, visual, basic, C, pocket, pc, palmari, career, summary, expert, system, administrator, unix, windows, win32, *nix, linux, solaris, windows, CE, wireless, customize, opportunities" name=keywords><LINK href="programmare_irda_file/filelist.xml" 
rel=File-List><o:SmartTagType name="PersonName" 
namespaceuri="urn:schemas-microsoft-com:office:smarttags"></o:SmartTagType><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]>
<OBJECT id=ieooui classid=clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D></OBJECT>
<STYLE>st1\:* {
	BEHAVIOR: url(#ieooui)
}
</STYLE>
<![endif]-->
<STYLE>@page Section1 {size: 595.3pt 841.9pt; margin: 70.85pt 57.6pt 2.0cm 57.6pt; mso-header-margin: 35.4pt; mso-footer-margin: 35.4pt; mso-paper-source: 0; }
P.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0cm 0cm 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
LI.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0cm 0cm 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
DIV.MsoNormal {
	FONT-SIZE: 12pt; MARGIN: 0cm 0cm 0pt; FONT-FAMILY: "Times New Roman"; mso-style-parent: ""; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
P.MsoPlainText {
	FONT-SIZE: 10pt; MARGIN: 0cm 0cm 0pt; FONT-FAMILY: "Courier New"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
LI.MsoPlainText {
	FONT-SIZE: 10pt; MARGIN: 0cm 0cm 0pt; FONT-FAMILY: "Courier New"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
DIV.MsoPlainText {
	FONT-SIZE: 10pt; MARGIN: 0cm 0cm 0pt; FONT-FAMILY: "Courier New"; mso-pagination: widow-orphan; mso-fareast-font-family: "Times New Roman"
}
SPAN.SpellE {
	mso-style-name: ""; mso-spl-e: yes
}
SPAN.GramE {
	mso-style-name: ""; mso-gram-e: yes
}
DIV.Section1 {
	page: Section1
}
</STYLE>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Tabella normale";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--></HEAD>
<BODY lang=IT style="tab-interval: 35.4pt">
<DIV class=Section1>
  <P class=MsoPlainText>Alcuni suggerimenti su come programmare i device ad Infrarossi 
    (IrDa).</P>
  <P class=MsoPlainText>- Include esempio scritto in <SPAN class=SpellE>Embedded</SPAN> 
    Visual Basic 3.0 (Windows Ce 3.0) -</P>
  <P class=MsoPlainText>(C) 2002 Berardi Michele<br>
    http://web.tiscali.it/mberardi</P>
  <P class=MsoPlainText><o:p>&nbsp;</o:p></P>
  <P class=MsoPlainText><o:p></o:p></P>
  <P class=MsoPlainText><o:p></o:p></P>
  <P class=MsoPlainText><SPAN class=GramE>I</SPAN> <SPAN 
class=SpellE>device</SPAN> ad infrarossi sono connessi al BCR (un <SPAN 
class=SpellE>device</SPAN> seriale).</P>
<P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText>Il BCR non può inviare messaggi alle periferiche <SPAN 
class=SpellE>irda</SPAN> circa la</P>
<P class=MsoPlainText><SPAN class=GramE>velocità</SPAN> di comunicazione, quindi 
bisogna settare a priori su</P>
<P class=MsoPlainText><SPAN class=GramE>entrambe</SPAN> le periferiche <SPAN 
class=SpellE>irda</SPAN> la stessa velocità di comunicazione.</P>
<P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText>I valori di <SPAN class=SpellE>default</SPAN> di solito 
sono 9600<SPAN class=GramE>,</SPAN>N,8,1.</P>
<P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText>I <SPAN class=SpellE>device</SPAN> <SPAN 
class=SpellE>Irda</SPAN> hanno bisogno di una corrente di 12 <SPAN 
class=SpellE><SPAN class=GramE>milliampere</SPAN></SPAN></P>
<P class=MsoPlainText><SPAN class=GramE>proveniente</SPAN> dal BCR, o in 
alternativa da una batteria o alimentatore</P>
<P class=MsoPlainText>esterno.</P>
<P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText>La connessione <SPAN class=SpellE>avviente</SPAN> di 
solito tramite un connettore <SPAN class=GramE>seriale</SPAN></P>
<P class=MsoPlainText><SPAN class=GramE>9 pin femmina</SPAN>, il quale prende 
l'alimentazione dai pin di <SPAN class=SpellE>handshaking</SPAN>.</P>
<P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText>Per testare la comunicazione <SPAN 
class=SpellE>Irda</SPAN> usando un PC dotato di porta <SPAN 
class=SpellE>Irda</SPAN><SPAN class=GramE>,</SPAN></P>
<P class=MsoPlainText><SPAN class=GramE>si</SPAN> può utilizzare un semplice 
emulatore di terminale sul <SPAN class=SpellE>pc</SPAN> settando</P>
<P class=MsoPlainText><SPAN class=GramE>come</SPAN> parametri di comunicazione 
9600,N,8,1 ed ovviamente selezionando</P>
  <P class=MsoPlainText><SPAN class=GramE>la</SPAN> porta seriale assegna all'<SPAN class=SpellE>Irda</SPAN> 
    (la porta deve essere correttamente<br>
    installata e funzionante sul sistema).</P>
<P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText>Se si vuole scrivere <SPAN class=SpellE><SPAN 
class=GramE>un'applicativo</SPAN></SPAN> per la comunicazione <SPAN 
class=SpellE>IrDa</SPAN>,</P>
<P class=MsoPlainText><SPAN class=GramE>si</SPAN> ricordi di settare alti(<SPAN 
class=SpellE>true</SPAN> per il VB) i valori DTR e RTS</P>
<P class=MsoPlainText><SPAN class=GramE>nelle</SPAN> proprietà dell'Oggetto COM, 
altrimenti la comunicazione</P>
<P class=MsoPlainText><SPAN class=GramE>può</SPAN> non avvenire per mancanza di 
energia,</P>
<P class=MsoPlainText><SPAN class=GramE>inoltre</SPAN> per l'oggetto COM in 
questione bisogna settare le proprietà</P>
<P class=MsoPlainText><SPAN class=SpellE>Rthreshold</SPAN> = 1 e <SPAN 
class=SpellE>Strheshold</SPAN> = 0.<o:p></o:p></P>
<P class=MsoPlainText>&nbsp;<o:p></o:p></P>
<P class=MsoPlainText>&nbsp;<o:p></o:p></P>
  <P class=MsoPlainText><SPAN class=GramE>esempio</SPAN> di codice visual basic:</P>
  <P class=MsoPlainText>&nbsp;</P>

<table cellpadding=5 width="100%" bgcolor=#e0e0e0 border=0>
  <tbody>
    <tr> 
        <td> <P class=MsoPlainText>'</P>
          <P class=MsoPlainText>' creare <SPAN class=SpellE>un'oggetto</SPAN> 
            <SPAN 
class=SpellE>com</SPAN> e settarlo come descritto sopra</P>
          <P class=MsoPlainText>' <SPAN class=SpellE>assegnadogli</SPAN> la porta 
            <SPAN 
class=SpellE>Irda</SPAN> (di solito COM4)</P>
          <P class=MsoPlainText><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">'<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">&nbsp;<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">Option 
            Explicit<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">&nbsp;<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">Private 
            Sub <SPAN class=SpellE>Ricevi</SPAN>(<SPAN 
class=SpellE>dati</SPAN>)<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN class=SpellE><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">testoricevuto.SelStart</SPAN></SPAN><SPAN 
lang=EN-GB style="mso-ansi-language: EN-GB"> = Len(<SPAN 
class=SpellE><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">testoricevuto</SPAN>.Text</SPAN>)<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN class=SpellE>testoricevuto.SelText</SPAN> 
            = dati</P>
          <P class=MsoPlainText>End Sub</P>
          <P class=MsoPlainText>&nbsp;</P>
          <P class=MsoPlainText>Private Sub <SPAN 
class=SpellE>InviaTesto_Click</SPAN>()</P>
          <P class=MsoPlainText><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">Comm1.Output = <SPAN 
class=SpellE>testoricevuto.Text</SPAN><o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">End 
            Sub<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">&nbsp;<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">Private 
            Sub Comm1_OnComm()<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">If 
            Comm1.CommEvent = 2 Then Call <SPAN 
class=SpellE>Ricevi</SPAN>(Comm1.Input)<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">End 
            Sub<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB 
style="mso-ansi-language: EN-GB">&nbsp;<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">Private 
            Sub <SPAN class=SpellE>Form_Load</SPAN>()<o:p></o:p></SPAN></P>
          <P class=MsoPlainText><SPAN lang=EN-GB style="mso-ansi-language: EN-GB">If 
            Not Comm1.PortOpen Then Comm1.PortOpen = True<o:p></o:p></SPAN></P>
          <P class=MsoPlainText>End Sub</P>
          </td>
    </tr>
  </tbody>
</table>

  <P class=MsoPlainText>&nbsp;</P>
<P class=MsoPlainText><o:p>&nbsp;</o:p></P>
<P class=MsoPlainText style="TEXT-ALIGN: justify">&nbsp;Berardi 
Michele<o:p></o:p></P>
<P class=MsoPlainText>Senior <SPAN class=SpellE>Developer</SPAN><o:p></o:p></P>
<P class=MsoPlainText>"<SPAN class=SpellE>customize</SPAN> <SPAN 
class=SpellE>your</SPAN> <SPAN 
class=SpellE>opportunities</SPAN>!"<o:p></o:p></P>
<P class=MsoPlainText><SPAN style="mso-spacerun: yes">&nbsp;&nbsp; 
</SPAN>Mobile: +39<SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN>347 
319 2000<o:p></o:p></P>
<P class=MsoPlainText><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Tel: +39 (0)881 
61 12 17<o:p></o:p></P>
<P class=MsoPlainText>E-Mail(S):<o:p></o:p></P>
<P class=MsoPlainText><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>mfxaub@tin.it<o:p></o:p></P>
<P class=MsoPlainText><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><st1:PersonName>03473192000@vizzavi.it</st1:PersonName><o:p></o:p></P>
<P class=MsoPlainText><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>Web:<o:p></o:p></P>
<P class=MsoPlainText>http://web.tiscalinet.it/mberardi<o:p></o:p></P>
<P class=MsoPlainText>&nbsp;</P></DIV></BODY></HTML>
